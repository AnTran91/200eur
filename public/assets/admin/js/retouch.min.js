!function(i,e){i.Retouch=function(i){this.$wrapper=i,this.$wrapper.on("change",".js-update-the-form",this.onChange.bind(this)),this.$wrapper.on("change",".js-retouch-type",this.onChange.bind(this)),this.init.bind(this),this.init()},e.extend(i.Retouch.prototype,{init:function(){this.$wrapper.find(".js-collection").length>0&&this.$wrapper.find(".js-collection").collection({allow_up:!1,allow_down:!1,add_at_the_end:!0,min:1,after_init:function(i){e(i).find(".js-delivery-time").chained(".js-retouch-type")},after_add:function(i,n){e(n).find(".js-delivery-time").chained(".js-retouch-type")}}),this.$wrapper.find(".js-wyswyg-selector").trumbowyg()},handleSubmit:function(i){var n=this;e.ajax({url:i.attr("action"),method:i.attr("method"),data:i.serializeArray(),beforeSend:function(){n.$wrapper.find("#dynamic-body").css("opacity","0.2"),n.$wrapper.find("#dynamic-body").append('<div class="loader"></div>')},success:function(i){var t=e(i).find("#dynamic-body");t.find(".form-group").removeClass("is-invalid"),t.find(".form-control").removeClass("is-invalid"),t.find(".form-group").each(function(){e(this).find(".invalid-feedback").remove()}),n.$wrapper.find("#dynamic-body").replaceWith(t),n.init()},error:function(i,e,t){n.$wrapper.find("#dynamic-body").css("opacity","1"),n.$wrapper.find("#dynamic-body .loader").remove(),alertify.error("something went wrong sorry about that. please try again later.",5)}})},onChange:function(i){i.preventDefault(),this.handleSubmit(e(i.currentTarget).closest("form"))}})}(window,jQuery);